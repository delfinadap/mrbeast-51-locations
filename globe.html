<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MrBeast Puzzle — 3D Globe</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: system-ui, -apple-system, sans-serif; background: #000; color: #eee; overflow: hidden; }
  #globe { width: 100vw; height: 100vh; }
  .header {
    position: absolute; top: 0; left: 0; right: 0; z-index: 10;
    padding: 12px 20px; background: rgba(22,33,62,0.85); backdrop-filter: blur(8px);
    border-bottom: 1px solid #333;
  }
  .header h1 { font-size: 18px; margin-bottom: 4px; }
  .header .sub { font-size: 12px; color: #888; }
  .legend {
    position: absolute; bottom: 0; left: 0; right: 0; z-index: 10;
    display: flex; gap: 16px; padding: 10px 20px;
    background: rgba(22,33,62,0.85); backdrop-filter: blur(8px);
    border-top: 1px solid #333; flex-wrap: wrap; align-items: center;
  }
  .legend-item { display: flex; align-items: center; gap: 6px; font-size: 13px; }
  .legend-dot { width: 12px; height: 12px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.3); }
  .filters { display: flex; gap: 6px; margin-left: auto; flex-wrap: wrap; }
  .toggle { display: flex; align-items: center; gap: 6px; font-size: 12px; color: #aaa; cursor: pointer; user-select: none; }
  .toggle input { cursor: pointer; }
  .stats { font-size: 12px; color: #aaa; display: flex; gap: 18px; margin-top: 4px; align-items: center; }
  .stats .num { font-weight: 700; color: #eee; }
  .stats .sep { color: #444; }
</style>
</head>
<body>

<div class="header">
  <h1>MrBeast Million Dollar Puzzle — 3D Globe</h1>
  <div class="sub">Drag to rotate. Scroll to zoom. Click points for details. Feedback? <a href="https://discord.gg/KCtjNMJeYv" style="color:#66f" target="_blank">discord.gg/KCtjNMJeYv</a></div>
  <div class="stats" id="stats"></div>
</div>

<div id="globe"></div>

<div class="legend">
  <div class="legend-item"><div class="legend-dot" style="background:#22c55e"></div> Confirmed</div>
  <div class="legend-item"><div class="legend-dot" style="background:#f59e0b"></div> Probable</div>
  <div class="legend-item"><div class="legend-dot" style="background:#ef4444"></div> Unconfirmed / Disputed</div>
  <div class="legend-item" style="margin-left:8px;color:#444">|</div>
  <div class="legend-item"><div class="legend-dot" style="background:#888"></div> Stage 1 (dots)</div>
  <div class="legend-item"><div class="legend-dot" style="background:transparent;border:2px solid #888;box-shadow:0 0 4px #888"></div> beast.travel (rings)</div>
  <div class="filters">
    <label class="toggle"><input type="checkbox" checked id="fConfirmed"> <span style="color:#22c55e">Confirmed</span></label>
    <label class="toggle"><input type="checkbox" checked id="fProbable"> <span style="color:#f59e0b">Probable</span></label>
    <label class="toggle"><input type="checkbox" checked id="fUnconfirmed"> <span style="color:#ef4444">Unconfirmed</span></label>
    <span style="color:#444; margin: 0 4px">|</span>
    <label class="toggle"><input type="checkbox" id="fBeastTravel"> beast.travel</label>
  </div>
</div>

<script src="https://unpkg.com/globe.gl@2.35.1/dist/globe.gl.min.js"></script>
<script>

const CSV = `name,country,lat,lng,category,confidence,puzzle,notes
Maputo,Mozambique,-25.9692,32.5732,playlist,confirmed,Playlist setup,First letters spell MAPUTO
Kandi,Benin,11.1308,2.9383,screen-bank,probable,Screen 1 + Magazine,>J> → K AND I + Benioff → KANDI BENIN. Grid row 57 (5+5) ✓.
Seoul,South Korea,37.5665,126.978,screen-bank,confirmed,Screen 2 + Calendar,RAINCOAT→CROATIAN calendar→SEOUL.
Cairo,Egypt,30.0444,31.2357,screen-bank,confirmed,Screen 3 + Feastables,Candyland color indexing
Upper Hutt,New Zealand,-41.1244,175.0707,screen-bank,probable,Screen 4 + Withdrawal slip,T9 decode → UPPER HUTT (not Lower Hutt). in list
Ankara,Turkey,39.9334,32.8597,screen-bank,confirmed,Screen 5 + Parking,ARA+ANK from spider/ballerina+tank/bank
Tbilisi,Georgia,41.7151,44.8271,screen-bank,probable,Screen 6 + Bird/Coffee,Bird cipher DINAMO + Georgia outline
Toad Suck,USA,35.0784,-92.5832,screen-bank,confirmed,Screen 7 + IPESIT/Pirate,3 parts: TOAD+SUCK+ARKANSAS.
Tijuana,Mexico,32.5149,-117.0382,screen-bank,confirmed,Screen 8 + Poster,Triple Caesar pun → SALAD ORIGIN
Moscow,Russia,55.7558,37.6173,screen-bank,confirmed,Screen 12 + Rubik's Cube,Red+Cube=Red Square.
Accra,Ghana,5.6037,-0.187,commercial,confirmed,Vault door Scrabble,Scrabble tile values
Kabul,Afghanistan,34.5553,69.2075,commercial,confirmed,Morse code light,Light flashes Morse backwards
Arles,France,43.6767,4.6278,commercial,confirmed,Laser pattern,LASER MIX UP anagram
Kupang,Indonesia,-10.1772,123.607,commercial,confirmed,Clipboard overlay,Capital of East Nusa Tenggara
Lahore,Pakistan,31.5204,74.3587,commercial,confirmed,Periodic dots,Atomic numbers → LA HO RE
Lima,Peru,-12.0464,-77.0428,commercial,confirmed,Belt wire colors,Color code 12-7-13-1
Tashkent,Uzbekistan,41.2995,69.2401,commercial,confirmed,Marked bills / Cash Pile,Spoonerism: Cash Tent → Tash Kent
Tallinn,Estonia,59.437,24.7536,commercial,confirmed,Subtitles,Hyphens → Seven Letter Big Lodge → tall inn
New Orleans,USA,29.9511,-90.0715,commercial,unconfirmed,Tank numbers + I scream,Low community confidence
Yellowstone,USA,44.428,-110.5885,commercial,confirmed,Smoke grenade,YELLOW+S+T+ONE=YELLOWSTONE. 
Algiers,Algeria,36.7538,3.0588,gift,confirmed,Airrack photos,A-L-G-I-E-R-S
Tampa Bay,USA,27.9506,-82.4572,gift,confirmed,Sketch gift,Madden 99 → BUCS HOME. beast.travel confirms 5+3+7 format.
Wichita,USA,37.6872,-97.3301,gift,confirmed,Jimmy Fallon jigsaw,BeastBot: giver not recipient = MrBeast born Wichita.
Tierra del Fuego,Argentina,-54.8019,-68.303,gift,confirmed,Quackity sword,Beagle Channel
DeKalb,USA,41.9295,-88.7503,gift,confirmed,Hayleybaylee rings,Rings puzzle
Montreal,Canada,45.5017,-73.5673,gift,confirmed,Jim & Monika hearts,MAD Magazine fold-in.
Cairns,Australia,-16.9186,145.7781,gift,confirmed,Chris Hemsworth,LAND OF CAIRNS → Queensland
Divo,Côte d'Ivoire,5.8372,-5.3597,gift,confirmed,Jack McKenna card trick,Card trick decode
Copenhagen,Denmark,55.6761,12.5683,gift,confirmed,Pierson blender,HAFNIUM CITY
Buffalo,USA,42.8864,-78.8784,gift,confirmed,Botez Sisters chess,Chess Game 6 cipher
Quito,Ecuador,-0.1807,-78.4678,commercial,confirmed,YouTube Short mirror,KEY-TOW-HECK-QUID-DOOR phonetic
Malé,Maldives,4.1755,73.5093,salesforce,probable,Malcolm in Water (BTS),Male Mal dives.
Iturup,Russia,45.1567,147.9164,salesforce,confirmed,Submarine Math (BTS),Sub count + grid → ASCII.
Yellowknife,Canada,62.454,-114.3718,salesforce,confirmed,BTS Puzzle Maker,Multiple sources confirmed
Thane,India,19.2183,72.9781,salesforce,probable,Elephant 85673,85673 → THANE.
Nazaré,Portugal,39.6021,-9.0686,salesforce,confirmed,Salesforce Tower LED,SURF RECORD SITE WITH ARGENT HUE
Nome,USA,64.5011,-165.4064,salesforce,confirmed,Billboard letters,Read backwards → NOME.
Dimtu,Ethiopia,6.9319,38.1278,salesforce,confirmed,Billboard numbers,04 09 13 20 21 → DIMTU.
Gaborone,Botswana,-24.6282,25.9079,salesforce,probable,FAQ page,PRATE OR THIS → prate synonym = GABS = Gaborone. Grid row 8 (8+8) ✓.
Antananarivo,Madagascar,-18.8792,47.5079,salesforce,confirmed,Dot-Dollar video,Nick dot puzzle solve. BeastBot confirmed. Grid row 86 (12+10) ✓.
Casablanca,Morocco,33.5731,-7.5898,salesforce,confirmed,Slack emoji,CA-SA-BL-AN-CA. Category uncertain
Heard Island,Australia,-53.1,73.5,lonesharksocial,confirmed,Bluesky homophones,Remote island
Île de la Possession,French Southern Territories,-46.4,51.8,lonesharksocial,confirmed,Podcast anagram,Crozet Islands
Ascension Island,UK,-7.9467,-14.3559,lonesharksocial,confirmed,Facebook/BGG,BGG rankings acrostic
Eyjafjallajökull,Iceland,63.63,-19.62,crossword,confirmed,Crossword circled cells,16 circled cells anagram
Casper,USA,42.8666,-106.3131,beast-travel,probable,Car: BARODYNAMICS,Oil City nickname
Arzamas,Russia,55.392,43.8131,beast-travel,probable,Car: EBULLIOSCOPE,City of 33 churches
Maiduguri,Nigeria,11.8311,13.151,beast-travel,unconfirmed,Car: FURFURACEOUS,Home of Peace.
Baku,Azerbaijan,40.4093,49.8671,beast-travel,confirmed,Car: HAPAXANTHOUS,City of Winds
Winnipeg,Canada,49.8951,-97.1384,beast-travel,unconfirmed,Car: HEKISTOTHERM,Capital + jets/plains. ⚠️ No grid row fits.
Surat,India,21.1702,72.8311,beast-travel,confirmed,Car: INCLINOMETER,Diamond City of India.
Marquette,USA,46.5436,-87.3954,beast-travel,probable,Car: MARIMBAPHONE,Queen City of the North
Beatty,USA,36.9086,-116.7592,beast-travel,confirmed,Car: NEBULOPHOBIA,Gateway to Death Valley.
Mosul,Iraq,36.34,43.13,beast-travel,confirmed,Car: OCHROLEUCOUS,Pearl of the North (Arabic).
Visby,Sweden,57.6348,18.2948,beast-travel,confirmed,Car: RECEPTACULAR,City of Roses + City of Ruins.
Istanbul,Turkey,41.0082,28.9784,beast-travel,probable,Car: RISORGIMENTO,City on Two Continents.
Nantucket,USA,41.2835,-70.0995,beast-travel,unconfirmed,Car: SALAMANDROID,Lady of the Sea.
Mayotte,France,-12.8275,45.1662,beast-travel,probable,Car: SCAPULOMANCY,Island of Death (partial).
Giresun,Turkey,40.9128,38.3895,beast-travel,probable,Car: THEANTHROPIC,Motherland of Cherry. Official city website
L'Ascension,Canada,46.6747,-74.075,beast-travel,unconfirmed,Car: ULTRAMONTANE,Valley of the Rouge. CanCon
Okato,New Zealand,-39.191,173.88,beast-travel,confirmed,Horse: ABERUNCATORS,W3W confirmed
Nova Russas,Brazil,-4.7042,-40.5631,beast-travel,confirmed,Horse: DEAMBULATORY,W3W confirmed
České Budějovice,Czech Republic,48.9745,14.4746,beast-travel,confirmed,Horse: FISSICOSTATE,W3W towers.decoder.models
Christchurch,New Zealand,-43.5321,172.6362,beast-travel,confirmed,Horse: LACHRYMIFORM,W3W driven.hint.improving
Castelo Branco,Portugal,39.8223,-7.4931,beast-travel,confirmed,Horse: LAEVODUCTION,W3W dusts.enigma.desks
Sokode,Togo,8.9833,1.1333,beast-travel,confirmed,Horse: OLERICULTURE,W3W calibrate.charted.nuzzle.
Curicó,Chile,-34.9828,-71.2394,beast-travel,probable,Horse: SCAFFMASTERS,W3W quiz.delivers.equality
Monkey Bay,Malawi,-14.0833,34.9167,beast-travel,confirmed,Horse: UNDERBRIDGES,W3W cryptically.packaging.bathrooms.
Antalya,Turkey,36.8969,30.7133,beast-travel,probable,Horse: WINDCHEATERS,W3W sticky.rejected.jigsaw
Ambanja,Madagascar,-13.6847,48.4497,beast-travel,confirmed,Plane: ABOUTSLEDGES,Otiv Mandroso bank
Saint-Pierre,Saint Pierre and Miquelon,46.7811,-56.1764,beast-travel,confirmed,Plane: ABSQUATULATE,Lighthouse matched
Krasnodar,Russia,45.0355,38.9753,beast-travel,confirmed,Plane: ECTYPOGRAPHY,Russian street signs
Tucumán,Argentina,-26.8083,-65.2176,beast-travel,confirmed,Plane: ELEEMOSYNARY,Mercedes Sosa Theater
Derby,Australia,-17.3089,123.6275,beast-travel,confirmed,Plane: EPANASTROPHE,Derby Wharf
Manaus,Brazil,-3.119,-60.0217,beast-travel,confirmed,Plane: EXSANGUINOUS,GeoGuessr near MUSA
Pune,India,18.5196,73.8553,beast-travel,confirmed,Plane: LAMPADEPHORE,GeoGuessr near synagogue
Hasik,Oman,17.4756,55.2296,beast-travel,confirmed,Plane: LIGNIPERDOUS,GeoGuessr near waterfalls
Velingrad,Bulgaria,42.0275,23.9917,beast-travel,confirmed,Plane: MACHAIRODONT,Lukoil roundabout.
Marrakesh,Morocco,31.6295,-7.9811,beast-travel,confirmed,Plane: NARRISCHKEIT,YSL Museum
Orlando,USA,28.5383,-81.3792,beast-travel,confirmed,Plane: ODORIVECTORS,Airport entrance
Charlotte,USA,35.2271,-80.8431,beast-travel,confirmed,Plane: SAPONIFIABLE,NASCAR HoF
Edmonton,Canada,53.5461,-113.4938,beast-travel,confirmed,Plane: SERPENTICIDE,Muttart Conservatory
Vladivostok,Russia,43.1332,131.9113,beast-travel,confirmed,Plane: SNALLYGASTER,Golden Horn Bay
Cochabamba,Bolivia,-17.3895,-66.157,beast-travel,confirmed,Plane: TERAMORPHOUS,Christ of the Concord
Tacurong,Philippines,6.6925,124.6764,beast-travel,confirmed,Plane: WINTERBOURNE,Talakudong Rotunda
Regina,Canada,50.4452,-104.6189,beast-travel,confirmed,Car photo puzzle,Image match → REGINA`;

// Parse CSV
function parseCSV(csv) {
  const lines = csv.trim().split('\n');
  const headers = lines[0].split(',');
  return lines.slice(1).map(line => {
    const vals = line.split(',');
    const obj = {};
    headers.forEach((h, i) => obj[h.trim()] = vals[i]?.trim() || '');
    obj.lat = parseFloat(obj.lat);
    obj.lng = parseFloat(obj.lng);
    return obj;
  });
}

const locations = parseCSV(CSV);

const colors = {
  confirmed: '#22c55e',
  probable: '#f59e0b',
  unconfirmed: '#ef4444',
  disputed: '#ef4444'
};

const categoryLabels = {
  'playlist': 'Playlist',
  'screen-bank': 'Screen + Bank',
  'commercial': 'Commercial',
  'gift': 'Gift',
  'lonesharksocial': 'Lone Shark Social',
  'crossword': 'Crossword',
  'salesforce': 'Salesforce',
  'beast-travel': 'beast.travel'
};

// Filter state
const filters = { confirmed: true, probable: true, unconfirmed: true, disputed: true, beastTravel: false };

function passesFilter(loc) {
  const confKey = loc.confidence === 'disputed' ? 'unconfirmed' : loc.confidence;
  if (!filters[confKey]) return false;
  if (loc.category === 'beast-travel' && !filters.beastTravel) return false;
  return true;
}

function getStage1() { return locations.filter(l => l.category !== 'beast-travel' && passesFilter(l)); }
function getBeastTravel() { return locations.filter(l => l.category === 'beast-travel' && passesFilter(l)); }

function makeLabel(d) {
  const cat = categoryLabels[d.category] || d.category;
  const col = colors[d.confidence] || '#888';
  return `
    <div style="font-family:system-ui;background:rgba(22,33,62,0.92);padding:10px 14px;border-radius:8px;border:1px solid #444;min-width:220px;backdrop-filter:blur(8px)">
      <div style="font-size:15px;font-weight:700;margin-bottom:4px">${d.name}, ${d.country}</div>
      <div style="font-size:11px;color:#666;margin-bottom:6px">${d.lat.toFixed(4)}, ${d.lng.toFixed(4)}</div>
      <div style="font-size:13px;margin-bottom:3px"><b>Category:</b> ${cat}</div>
      <div style="font-size:13px;margin-bottom:3px"><b>Confidence:</b> <span style="color:${col};font-weight:600">${d.confidence.toUpperCase()}</span></div>
      <div style="font-size:12px;color:#aaa;margin-top:4px">${d.puzzle}</div>
      <div style="font-size:11px;color:#666;margin-top:2px">${d.notes}</div>
    </div>`;
}

// Combine all visible locations into one array for the points layer
function getAllVisible() {
  return locations.filter(passesFilter);
}

// Build globe — all locations as native points (fully interactive)
const globe = Globe()
  .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-night.jpg')
  .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
  .pointsData(getAllVisible())
  .pointLat('lat')
  .pointLng('lng')
  .pointColor(d => colors[d.confidence] || '#888')
  .pointRadius(d => d.category === 'beast-travel' ? 0.4 : 0.5)
  .pointAltitude(0.01)
  .pointLabel(makeLabel)
  // beast.travel: rings around points for visual distinction
  .ringsData(getBeastTravel())
  .ringLat('lat')
  .ringLng('lng')
  .ringColor(d => () => colors[d.confidence] || '#888')
  .ringMaxRadius(1.2)
  .ringPropagationSpeed(0.8)
  .ringRepeatPeriod(2000)
  .ringAltitude(0.01)
  (document.getElementById('globe'));

// Adjust camera
globe.pointOfView({ lat: 30, lng: 30, altitude: 2.2 });

// Handle resize
window.addEventListener('resize', () => {
  globe.width(window.innerWidth);
  globe.height(window.innerHeight);
});

// Stats — always show both Stage 1 and beast.travel breakdowns
function breakdownStr(locs) {
  const c = locs.filter(l => l.confidence === 'confirmed').length;
  const p = locs.filter(l => l.confidence === 'probable').length;
  const u = locs.filter(l => l.confidence === 'unconfirmed').length;
  const d = locs.filter(l => l.confidence === 'disputed').length;
  const parts = [];
  if (c) parts.push(`${c} confirmed`);
  if (p) parts.push(`${p} probable`);
  if (u) parts.push(`${u} unconfirmed`);
  if (d) parts.push(`${d} disputed`);
  return parts.join(', ');
}

function updateStats() {
  const s1All = locations.filter(l => l.category !== 'beast-travel');
  const btAll = locations.filter(l => l.category === 'beast-travel');
  document.getElementById('stats').innerHTML =
    `<span>Stage 1: <span class="num">${s1All.length}</span> (${breakdownStr(s1All)})</span>` +
    `<span class="sep">|</span>` +
    `<span>beast.travel: <span class="num">${btAll.length}</span> (${breakdownStr(btAll)})</span>`;
}

function refresh() {
  globe.pointsData(getAllVisible());
  globe.ringsData(getBeastTravel());
  updateStats();
}

// Filter listeners
document.getElementById('fConfirmed').addEventListener('change', e => { filters.confirmed = e.target.checked; refresh(); });
document.getElementById('fProbable').addEventListener('change', e => { filters.probable = e.target.checked; refresh(); });
document.getElementById('fUnconfirmed').addEventListener('change', e => {
  filters.unconfirmed = e.target.checked;
  filters.disputed = e.target.checked;
  refresh();
});
document.getElementById('fBeastTravel').addEventListener('change', e => { filters.beastTravel = e.target.checked; refresh(); });

updateStats();

</script>
</body>
</html>
